<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Les 5 pages</title>
	<link rel="stylesheet" href="5pages.css" />
	<script src="folding.js"></script>
</head>

<body><input type="checkbox" id="toutafficher" /><input type="checkbox" id="numeroter" />
	<div class="options">
	<label for="toutafficher">Tout afficher</label>
<!--	<label for="numeroter">Numéroter</label>-->
	</div>
	<div class="interface">
		<h1>Les 5 pages</h1>
		<div class="instructions">
			<p>Pour chacune des 5 pages-types de traitement d'une base de données, les instructions cochées doivent être exécutées dans l'ordre suivant.</p>
			<p>Ce n'est pas une mauvaise idée de créer une fonction ou une méthode d'objet permettant de les exécuter.</p>
		</div>
		<table class="cinqpages">
			<col class="nom" />
			<colgroup class="coches">
				<col class="liste" />
				<col class="details" />
				<col class="ajout" />
				<col class="modif" />
				<col class="suppr" />

			</colgroup>
			<thead>
				<tr>
					<th></th>
					<th class="liste"><span><em>Liste</em></span></th>
					<th class="details"><span><em>Détails</em></span></th>
					<th class="ajout"><span><em>Ajout</em></span></th>
					<th class="modif"><span><em>Modif.</em></span></th>
					<th class="suppr"><span><em>Suppr.</em></span></th>
				</tr>
			</thead>
			<tbody class="connexion">
				<tr class="liste details ajout modif suppr">
					<td>Connexion
						<div>
							<p>Création d'un objet PDO</p>
							<p><strong>MySql</strong> : <code>$pdo = new PDO($dsn, $username, $password);</code></p>
							<p><strong>SQLite</strong> : <code>$pdo = new PDO("sqlite:" . $chemin_bd);</code></p>
							<p>Prendre soin de donner les bonnes valeurs aux variables.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
			</tbody>
			<tbody class="traitement">
				<tr class="ajout modif suppr">
					<td>Vérification de réception d’un formulaire
						<div>
							<p>Vérifier si le champ caché témoin a été reçu.</p>
							<p>Mot-clé : <code>isset</code></p>
							<p>Toute cette section ne doit s'exécuter que si le témoin est présent.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="modif suppr">
					<td>Récupération de la clé primaire (POST)
						<div>
							<p>Est récupérée avant le reste du formulaire pour être utilisée lors de l'annulation.</p>
							<p>Mot-clé : <code>$_POST</code></p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Annulation de l'opération au besoin
						<div>
							<p>Vérifier si le bouton "annuler" a été cliqué (reçu).</p>
							<p>Dans un tel cas, on retourne habituellement à la page de liste ou à la page de détails.</p>
							<p>Mots-clés : <code>isset</code>, <code>header</code></p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif">
					<td>Récupération des données du formulaire
						<div>
							<p>Mettre la valeur de chaque champ de formulaire dans une variable locale portant le même nom.</p>
							<p><code>$donnee = $_POST['donnee'];</code></p>
							<p>À l'occasion, on fait un traitement sommaire comme supprimer les espaces au début et à la fin de la chaine.</p>
							<p>Mots-clés : <code>$_POST</code>, <code>trim</code></p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif">
					<td>Validation des données
						<div>
							<p>S'assurer que l'on a bien reçu les données attendues avec le format attendu.</p>
							<p>Cette pratique sera détaillée ultérieurement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif">
					<td>Traitement des données
						<div>
							<p>Faire en sorte que les données aient le type et le format attendu. Plusieurs techniques peuvent alors employées</p>
							<p>Quelques mots-clés : <code>strtoupper</code>, <code>str_replace</code>, <code>addslashes</code>, <code>intval</code>...</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Composition et préparation du SQL
						<div>
							<p>Composition d'une commande SQL de modification de bd en y incluant des paramètres PDO. Un paramètre PDO est un identifiant choisi par vous précédé d'un deux-points. Exemple : <code style="border:1px solid black;">:id</code></p>
							<p>Création d'un objet PODStatement pour notre SQL.</p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdo.prepare.php">prepare</a></code>, une méthode de notre objet PDO.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Liaison de paramètres à des variables
						<div>
							<p>Établir un lien entre les variables contenant les données et les paramètres PDO de notre SQL.</p>
							<p><code>$stmt-&gt;bindParam(":nomChamp", $nomChamp);</code></p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.bindparam.php">bindParam</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Exécution de la requête
						<div>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.execute.php">execute</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Redirection vers une autre page
						<div>
							<p>Habituellement, on n'a pas besoin de rafficher le formulaire. On fait donc une redirection.</p>
							<p>On peut rediriger vers la page de liste ou bien vers la page de détails en incluant la clé primaire dans l'adresse.</p>
							<p>Mot-clé : <code>header</code></p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
			</tbody>
			<tbody class="composition">
				<tr class="details modif suppr">
					<td>Récupération de la clé primaire (GET)<br/>avec renvoi en cas d’absence.
						<div>
							<p>Pour fonctionner, ces pages doivent recevoir par l'adresse la clé primaire d'un enregistrement.</p>
							<p>Si celle-ci n'est pas fournie, soit on affiche un message 404, soit on retourne directement vers la page d'accueil.</p>
							<p>Mots-clés : <code>$_GET</code>, <code>header</code></p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="liste details modif">
					<td>Composition et préparation du SQL (SELECT)
						<div>
							<p>Composition d'une commande SQL pour récupérer des données (SELECT).</p>
							<p>Création d'un objet PODStatement pour notre SQL.</p>
							<p><code>$stmt = $pdo-&gt;prepare($sql);</code></p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdo.prepare.php">prepare</a></code>, une méthode de notre objet PDO.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="details modif">
					<td>Liaison de paramètres à des variables
						<div>
							<p>Établir un lien entre les variables contenant les données et les paramètres PDO de notre SQL.</p>
							<p><code>$stmt-&gt;bindParam(":nomChamp", $nomChamp);</code></p>

							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.bindparam.php">bindParam</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="liste details modif">
					<td>Liaison de colonnes à des variables
						<div>
							<p>Établir un lien entre les colonnes de notre requête et des variables créées pour l'occasion.</p>
							<p><code>$stmt-&gt;bindColumn("nomChamp", $nomChamp);</code></p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.bindcolumn.php">bindColumn</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="liste details modif">
					<td>Exécution de la requête
						<div>
							<p><code>$stmt-&gt;execute();</code></p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.execute.php">execute</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="liste">
					<td>Récupération des enregistrements avec boucle
						<div>
							<p>Lorsqu'on a besoin de plusieurs enregistrements, on doit parcourir ceux-ci à l'aide d'une boucle.</p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.fetch.php">fetch</a></code>, une méthode de l'objet PDOStatement, <code>while</code>.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="details modif">
					<td>Récupération de l’enregistrement sans boucle
						<div>
							<p>Lorsqu'on n'a besoin que d'un seul enregistrement, la boucle n'est pas nécessaire.</p>
							<p>Mot-clé : <code><a target="_blank" href="http://php.net/manual/fr/pdostatement.fetch.php">fetch</a></code>, une méthode de l'objet PDOStatement.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="liste details modif">
					<td>Affichage des données
						<div>
							<p>Dans ces pages, on doit inclure, dans l'affichage, des données provenant de la base de données. Soit dans une mise en page normale, soit comme valeurs d'un formulaire.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="ajout modif suppr">
					<td>Utilisation d'un formulaire
						<div>
							<p>Ces pages utilisent un formulaire.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
				<tr class="modif suppr">
					<td>Clé primaire dans le formulaire
						<div>
							<p>Dans le formulaire de ces pages, on doit inclure un champ caché (hidden) représentant la clé primaire de l'enregistrement.</p>
							<p>Cette donnée provient habituellement de l'adresse.</p>
						</div>
					</td>
					<td class="liste"></td>
					<td class="details"></td>
					<td class="ajout"></td>
					<td class="modif"></td>
					<td class="suppr"></td>
				</tr>
			</tbody>
		</table>
		<footer>
			<div class="legende">
				Légende :
				<span class="connexion">Jaune = Section connexion</span>
				<span class="traitement">Vert = Section traitement</span>
				<span class="composition">Cyan = Section affichage</span>
			</div>
		</footer>
	</div>
</body>
</html>
